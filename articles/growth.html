<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Growth • ISRverse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Growth">
<meta property="og:description" content="ISRverse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ISRverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/growth.html">Growth</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fplard/ISRverse/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Growth</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fplard/ISRverse/blob/HEAD/vignettes/growth.Rmd" class="external-link"><code>vignettes/growth.Rmd</code></a></small>
      <div class="hidden name"><code>growth.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fplard/ISRverse" class="external-link">ISRverse</a></span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/flat_growth.Rmd: do not edit by hand -->
<!-- Run this 'development' chunk -->
<!-- Store every call to library() that you need to explore your functions -->
<div class="section level2">
<h2 id="gro_cleanmeasures">Gro_cleanmeasures<a class="anchor" aria-label="anchor" href="#gro_cleanmeasures"></a>
</h2>
<p>This function is used to prepare weight and length dataset. It unify
the unity used, select clean measures and add individual age at each
measure. This function takes as arguments:</p>
<ul>
<li>
<code>data</code>: the weight or length data from ZIMS</li>
<li>
<code>coresubse</code>: the core data of the species from ZIMS</li>
<li>
<code>CaptiveBirths</code> Should captive born individuals be
included, only? Default = TRUE</li>
<li>
<code>InclUnkSex</code>Should undetermined sexes be included Default
= FALSE</li>
<li>
<code>mindate</code> Earlier date to include data
(‘YYYY-MM-DD’)</li>
<li>
<code>MeasureType</code> Name of the type of measurements that
should be included. Default = NULL, all measurement type are
included.</li>
<li>
<code>type</code> Either ‘weight’ or ‘length’.</li>
</ul>
<p>The function returns the data frame including selected measures, plus
individual birth date and individual age at each measure</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">raw_weights</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">core</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_weights</span><span class="op">=</span> <span class="fu"><a href="../reference/Gro_cleanmeasures.html">Gro_cleanmeasures</a></span><span class="op">(</span><span class="va">raw_weights</span>, <span class="va">core</span>,</span>
<span>                                CaptiveBirths <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                MeasureType <span class="op">=</span> <span class="st">'Live weight'</span>,</span>
<span>                                InclUnkSex <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                mindate <span class="op">=</span> <span class="st">"1980-01-01"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gro_remoutliers">gro_remoutliers<a class="anchor" aria-label="anchor" href="#gro_remoutliers"></a>
</h2>
<p>This function removes the outliers from a dataset of weights. This
function takes as arguments:</p>
<ul>
<li>
<code>data_weight</code> a data frame that must include at least the
columns <code>MeasurementValue</code> and <code>Age</code>.</li>
<li>
<code>taxa</code> the name of the taxa studied</li>
<li>
<code>ageMat</code> the MINIMUM age at sexual maturity. The function
takes as threshold 1.2*ageMat to differentiate juveniles (still growing)
from adults</li>
<li><code>maxweight</code></li>
<li>
<code>variableid</code> name of the column including individual IDs.
Defaut = “anonID”. It must also be a column of
<code>data_weight</code>
</li>
<li>
<code>minq</code> Sensitivity of the function to remove outliers
using percentiles, between 0 and 1. Default = 0.025</li>
<li>
<code>IQR</code> influences the sensitivity of the function to
remove outliers using generalized additive model of growth. It should be
above 1 Default = 2.75. A higher number makes the function less
sensitive to find outliers.</li>
<li>
<code>perc_weight_min</code> Minimum percentage of weight that an
individual can naturally lose or gain during a year . Default = 0.2
(20%)</li>
<li>
<code>perc_weight_max</code> Maximum percentage of weight that an
individual can naturally lose or gain during a year . Default = 2.5
(250%)</li>
</ul>
<p>This function follow 4 different steps to highlight outliers: 1/ It
removes the measures higher than the argument <code>maxweight</code>
(Instead of using the OrdMag Fernando that was removing only very
extreme values, a maximum value was set for each taxa). In the default
case, default values are in kilograms and are set at 7000kg for
Mammalia, 200kg for Aves, 1500kg for Reptilia, 100kg for Amphibia,
1000kg for Chondrichthyes and 500kg for Actinopterygii. 2/ Independently
on adults and juveniles, it uses the function Gro_Rout_quan() to removes
outliers based on percentiles on adults and juveniles. It uses sliding
windows of age for juveniles. You can choose the number of intervals
used for the sliding windows using the argument
<code>Ninterval_juv</code>. 3/ Independently on adults and juveniles, it
uses the function Gro_lin_ind() to build generalized additive models for
each individual trajectories with at least <code>min_Nmeasures</code>
measures and remove outliers based on the residuals of the models. 4/ It
uses the function Gro_lin_ind() to build a common generalized additive
model for all growth trajectories and remove outliers based on the
residuals of the models.</p>
<p>The function returns:</p>
<ul>
<li>The data frame including the column <code>KEEP</code> a numeric
vector of 1 and 0 indicating the measures to keep. The 0 signal
outliers. Other additional columns keep1, keep2, keep3 indicates the
individuals highlighted as outliers (0) in steps 1 to 3.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="va">weights</span> <span class="op">=</span> <span class="fu"><a href="../reference/Gro_remoutliers.html">Gro_remoutliers</a></span><span class="op">(</span><span class="va">weights</span>, taxa <span class="op">=</span> <span class="st">"Mammalia"</span>, ageMat <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MeasurementValue</span> <span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">weights</span><span class="op">)</span></span>
<span><span class="co">#Show the four steps used to remove outliers</span></span>
<span><span class="co">#1/ using maximum value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">MeasurementValue</span> <span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">keep1</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> </span>
<span><span class="co">#2/ using Inter quartile range</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">MeasurementValue</span> <span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">keep2</span><span class="op">==</span><span class="fl">0</span>, <span class="va">keep1</span><span class="op">==</span><span class="fl">1</span> <span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"green"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> </span>
<span><span class="co">#3a/ using individual trajectories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">MeasurementValue</span> <span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">keep3</span><span class="op">==</span><span class="fl">0</span>, <span class="va">keep2</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"cyan"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> </span>
<span><span class="co">#3b/ using global log-linear model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">MeasurementValue</span> <span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">KEEP</span><span class="op">==</span><span class="fl">0</span>, <span class="va">keep3</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"blue"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> </span></code></pre></div>
<p><img src="growth_files/figure-html/examples-Gro_remoutliers-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Checking outliers highlighted in Individual trajectories</span></span>
<span><span class="va">anon</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">weights</span><span class="op">$</span><span class="va">anonID</span><span class="op">[</span><span class="va">weights</span><span class="op">$</span><span class="va">keep3</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">weights</span><span class="op">$</span><span class="va">keep2</span><span class="op">==</span><span class="fl">1</span> <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MeasurementValue</span> <span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">keep2</span><span class="op">==</span><span class="fl">1</span>, <span class="va">anonID</span> <span class="op">==</span> <span class="va">anon</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">MeasurementValue</span> <span class="op">~</span><span class="va">Age</span>, data <span class="op">=</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">keep3</span><span class="op">==</span><span class="fl">0</span>, <span class="va">anonID</span> <span class="op">==</span> <span class="va">anon</span>, <span class="va">keep2</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"cyan"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="growth_files/figure-html/examples-Gro_remoutliers-2.png" width="700"></p>
<div class="section level3">
<h3 id="remove-outliers-from-percentiles">Remove outliers from percentiles<a class="anchor" aria-label="anchor" href="#remove-outliers-from-percentiles"></a>
</h3>
<p>This functions removes all values lower and higher than the median
value multiplied by how many times the (100-q)th percentile is higher
than the qth percentile of the distribution of weights.</p>
<p>The measurement values must be positive</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">40</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Gro_Rout_quan.html">Gro_Rout_quan</a></span> <span class="op">(</span><span class="va">z</span>, minq <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="linearize-individual-trajectories">Linearize individual trajectories<a class="anchor" aria-label="anchor" href="#linearize-individual-trajectories"></a>
</h3>
<p>This function takes as arguments:</p>
<ul>
<li>
<code>data_weight</code> a data frame that must include at least the
columns <code>MeasurementValue</code> and <code>Age</code>and
<code>anonID</code>
</li>
<li>
<code>perc_weight_min</code> Minimum percentage of weight that an
individual can naturally lose or gain during a year. Default = 0.2
(20%)</li>
<li>
<code>perc_weight_max</code> Maximum percentage of weight that an
individual can naturally lose or gain during a year. Default = 2.5
(250%). This value is used only after 1 year old</li>
<li>
<code>IQR</code> influences the sensitivity of the function to
remove outliers. It should be above 1 Default = 1.5. A higher number
makes the function less sensitive to find outliers.</li>
<li>
<code>remove_ext</code> Do you want to keep the two first and two
last observations of individual trajectories? These points may often be
highlighted as false outliers. Default = TRUE</li>
<li>
<code>traj_ind</code> Do you want to build a model at the level of
the individual trajectory Default = TRUE. If yes, each individual
trajectory must have at least 5 measures.</li>
</ul>
<p>The function uses build generalized additive model of the measurement
value in relation to age. It flags as outliers all measures for which
the residuals from the linear model are above IQR * the inter quantile
interval (quantile(0.9) - quantile(0.1)) of the residuals.
<code>perc_weight_min</code> and <code>perc_weight_max</code> limit the
values that must be considered as outliers.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#We use only trajectories for which the number of individual datapoints is &gt; 6</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">anonID</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>nb<span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nb</span> <span class="op">&gt;</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weights_ind</span> <span class="op">&lt;-</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="../reference/Gro_lin_ind.html">Gro_lin_ind</a></span><span class="op">(</span>traj_ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">weights_ind</span><span class="op">$</span><span class="va">Keep2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    [1] 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;   [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;   [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [223] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [260] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1</span></span>
<span><span class="co">#&gt;  [297] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [334] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [371] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [408] 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [445] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [482] 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1</span></span>
<span><span class="co">#&gt;  [519] 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [556] 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [593] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [630] 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [667] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [704] 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [741] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [778] 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [815] 1 1 1 0 0 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1</span></span>
<span><span class="co">#&gt;  [852] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [889] 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [926] 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1</span></span>
<span><span class="co">#&gt;  [963] 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1000] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1</span></span>
<span><span class="co">#&gt; [1037] 1 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0</span></span>
<span><span class="co">#&gt; [1074] 1 1 1 1 1 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1111] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1148] 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1185] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 1 1</span></span>
<span><span class="co">#&gt; [1222] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1259] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1296] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1333] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1370] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; [1407] 1 1 1 1 1 1 1</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">weights_pop</span> <span class="op">&lt;-</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="../reference/Gro_lin_ind.html">Gro_lin_ind</a></span><span class="op">(</span>traj_ind <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="growth-model">Growth model<a class="anchor" aria-label="anchor" href="#growth-model"></a>
</h2>
<p>This function takes as arguments:</p>
<ul>
<li>
<code>data_weight</code> a data frame that must include at least the
columns <code>MeasurementValue</code> and <code>Age</code>.</li>
<li>
<code>variable_id</code> name of the variable including individual
ids. Defaut = “anonID”. It must also be a column of
<code>data_weight</code>
</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Floriane Plard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

---
title: "Reproduction"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{reproduction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(ISRverse)
```

<!-- WARNING - This vignette is generated by {fusen} from dev/flat_repro.Rmd: do not edit by hand -->

# Rep_main

`Rep_main` runs the age at sexual maturity and the litter size analysis. It uses at least the following arguments:

* cleaned `coresubset` including only the selected individuals. It must includes at least the following columns: *AnimalAnonID*, 'BirthType', *MaxBirthDate*, *MinBirthDate*, *DepartDate*, *BirthDate*,*SexType*, and *FirstHoldingInstitution*
* `collection`data including at least the following columns: *AnimalAnonID*, *ScopeType*, *ChangeDate*
* `parent` data including at least the following columns: *ParentAnonID*, *ParentCollectionScopeType*, *OffspringCollectionScopeType*, *AnimalAnonID*, *ParentOriginType*, *Probability*
* `move` data including at least the following columns: *AnimalAnonID*, *To*, *Date*
* `Repsect` names of the reproductive analyses to run: "agemat", "litter" and/or ...


It return a list per sex category including:
* a summary of the data used
* the output for the age at maturity if the analysis is selected
* the output for the litter size if the analysis is selected



```{r examples-Rep_main}

```

# Age at first reproduction

`Rep_agemat()` returns summary statistics for ages of reproduction. It uses the following argument:
* Reprodata, a data frame including at least the columns *ParentAnonID* and *Parent_Age*


```{r examples-Rep_agemat}
data(core)
data(collection)
data(parent)
data(moves)
#prepare Data
Data <- Rep_prepdata (coresubset = core, collection, parent, moves, 
                      minNrep = 1, minNparep = 1)
#Calculate summary for reproductive ages
out <- Rep_agemat(Data$Reprodata)
out

```

# Litter size

`Rep_littersize()` makes a data frame of litter size per parent and birth date and produces summary tables of litter size. It uses the following arguments:

* `Reprodata` including at least the columns *AnimalAnonID*, *ParentAnonID*, *ParentType*, *Probability*, *Offspring_BirthDate*, *Offspring_Inst* and *Parent_Age*
* `perAge`:  Whether to estimate litter size per mother age
* `Nday`: the number of consecutive days over which the birth dates of a litter/clutch can be spread

It returns a list including:
* A data frame with the litter size per mother and birth date
* A table including the number and proportion of each size of litter
* Summary statistics
* if perAge = TRUE, a table including the mean and standard deviation of litter size per maternal age


```{r examples-Rep_littersize}
data(core)
data(collection)
data(parent)
data(moves)
#prepare Data
Data <- Rep_prepdata (coresubset = core, collection, parent, moves, minNrep = 1, minNparep = 1,
                      BirthType_parent = "All", BirthType_offspring = "All" )

#Estimate litter size
out <- Rep_littersize(Data$Reprodata, perAge = FALSE,
                      Nday = 7)

out
```

# fertility

```{r examples-Rep_fert}

```

# Prepare data for reproduction

`Rep_prepdata()` prepares reproduction data including age of parent at birth, offspring sex and birth date and data of potential reproductive individuals at each age. It uses at least the following arguments:

* cleaned `coresubset` including only the selected individuals. It must includes at least the following columns: *AnimalAnonID*, 'BirthType', *MaxBirthDate*, *MinBirthDate*, *DepartDate*, *BirthDate*,*SexType*, and *FirstHoldingInstitution*
* `collection`data including at least the following columns: *AnimalAnonID*, *ScopeType*, *ChangeDate*
* `parent` data including at least the following columns: *ParentAnonID*, *ParentCollectionScopeType*, *OffspringCollectionScopeType*, *AnimalAnonID*, *ParentOriginType*, *Probability*
* `moves` data including at least the following columns: *AnimalAnonID*, *To*, *Date*



```{r examples-Rep_prepdata}
data(core)
data(collection)
data(parent)
data(moves)

Data <- Rep_prepdata (coresubset = core, collection, parent, moves,
                      BirthType_parent = "Captive", BirthType_offspring = "Captive"
)
```

# Seasonnality

```{r examples-Rep_season}

```


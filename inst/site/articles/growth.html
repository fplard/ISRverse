<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Growth • ISRverse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Growth">
<meta property="og:description" content="ISRverse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ISRverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data-selection.html">Data Selection</a>
    </li>
    <li>
      <a href="../articles/growth.html">Growth</a>
    </li>
    <li>
      <a href="../articles/reproduction.html">Reproduction</a>
    </li>
    <li>
      <a href="../articles/survival.html">Survival</a>
    </li>
    <li>
      <a href="../articles/taxon-profiles.html">Taxon profiles</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Growth</h1>
            
      
      
      <div class="hidden name"><code>growth.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ISRverse</span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/flat_growth.Rmd: do not edit by hand -->
<!-- Run this 'development' chunk -->
<!-- Store every call to library() that you need to explore your functions -->
<div class="section level2">
<h2 id="gro_main">Gro_Main<a class="anchor" aria-label="anchor" href="#gro_main"></a>
</h2>
<p>This function is the main function used to run the growth analysis
for taxon profiles. It selects measures, removes outliers, selects the
best growth model and produces the percentile of the best fitting growth
model for the sexes and birth types selected. It takes as arguments:</p>
<ul>
<li>
<code>data</code>: the weight or length data from ZIMS</li>
<li>
<code>coresubse</code>: the core data of the species from ZIMS</li>
<li>
<code>Taxa</code>: the name of the taxa studied</li>
<li>
<code>Species</code>: the name of the species studied</li>
<li>
<code>BirthType</code>: “Captive”, “Wild”, and/or “All”</li>
<li>
<code>AgeMat</code>: age at sexual maturity</li>
<li>
<code>models</code>: indicating the growth models that need to be
fit.The following models are supported : logistic, gompertz,
chapmanRichards, vonBertalanffy, polynomial</li>
<li>
<code>percentiles</code>: indicating the percentiles that need to be
estimated. default = c(2.5,97.5) corresponding to the 95% predicted
interval.</li>
<li>
<code>MinInstitution</code> Minimum number of institutions that
should hold records to run the analysis.</li>
<li>
<code>MinNGro</code>: Minimum number of weight needed to fit the
growth models</li>
<li>
<code>MinNIGro</code>: Minimum number of unique individuals needed
to fit the growth models</li>
<li>
<code>type</code>: Either ‘weight’ or ‘length’. Default =
’weight</li>
<li>
<code>MeasureType</code>: Name of the type of measurements that
should be included.</li>
<li>
<code>MinDate</code>: Earlier date to include data</li>
<li>
<code>PlotDir</code>: Directory to save the plots showing outliers
and predictions from best models</li>
</ul>
<p>The function returns a list including an analysis by sex and by birth
type as included in the input. Each analysis includes: * The fit of the
growth models with the AIC table of the model, the fit of the best
model, a data frame with the percentile selected and 3 GOF test
including the normality of residuals and the test of trend in residuals
against X and in the variance of the residuals. * A summary with the
number of individuals and weight used for the analysis: - NInd_raw and,
NWeight_raw indicate the number of unique individuals and the number of
weights once the sex, the birth type, the measurment type from global
collection have been selected - NWeight_val and NInd_val indicate the
number of unique individuals and the number of weights once valid
measurment from Husbandry have been selected - NJuv= 0 and NAd indicate
the number of weights of juveniles and adults selected - NJuv_keep= 0
and NAd_keep indicate the number of weights of juveniles and adults
selected after removing outliers - NWeight and NInd indicate the total
number of unique individuals and the number of weights used for the
analysis - a logical indicated if the growth analysis was performed - If
the growth analysis was not performed, an error and its number (Nerr)
are returned: The possibility for this functions are: 1/No raw data and
2/No valid weight measure 3/Data from 1 Institution 4/ NWeight &lt;
MinNGro 5/NInd &lt; MinNIGro 6/Best model did not fit.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">core</span><span class="op">)</span></span>
<span><span class="va">output</span><span class="op">=</span> <span class="fu"><a href="../reference/Gro_Main.html">Gro_Main</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">weights</span>, coresubse <span class="op">=</span> <span class="va">core</span>,</span>
<span>                 Taxa <span class="op">=</span> <span class="st">"Reptilia"</span>, Species <span class="op">=</span> <span class="st">"Testudo hermanni"</span> ,</span>
<span>                 BirthType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Captive"</span>, <span class="st">"Wild"</span><span class="op">)</span>, AgeMat <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 type <span class="op">=</span> <span class="st">"weight"</span>, MeasureType <span class="op">=</span> <span class="st">"Live weight"</span>,</span>
<span>                 MinNGro <span class="op">=</span> <span class="fl">30</span>, MinNIGro <span class="op">=</span> <span class="fl">30</span>, </span>
<span>                 models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vonBertalanffy"</span>, <span class="st">"logistic"</span><span class="op">)</span>, percentiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">97.5</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning in Gro_remoutliers(., Taxa = Taxa, AgeMat = AgeMat, maxweight = NULL, :</span></span>
<span><span class="co">#&gt; Multiple measurment types found in the data: Live weight, Data should often</span></span>
<span><span class="co">#&gt; include only one Measurement Type</span></span>
<span></span>
<span><span class="co">#&gt; Warning in Gro_remoutliers(., Taxa = Taxa, AgeMat = AgeMat, maxweight = NULL, :</span></span>
<span><span class="co">#&gt; Multiple measurment types found in the data: Live weight, Data should often</span></span>
<span><span class="co">#&gt; include only one Measurement Type</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gro_cleanmeasures">Gro_cleanmeasures<a class="anchor" aria-label="anchor" href="#gro_cleanmeasures"></a>
</h2>
<p>This function is used to prepare weight and length dataset. It unify
the unity used, select clean measures and add individual age at each
measure. This function takes as arguments:</p>
<ul>
<li>
<code>data</code>: the weight or length data from ZIMS</li>
<li>
<code>coresubse</code>: the core data of the species from ZIMS</li>
<li>
<code>BirthType</code> Captive, Wild, or All Default = “All”</li>
<li>
<code>MinDate</code> Earlier date to include data
(‘YYYY-MM-DD’)</li>
<li>
<code>UncertDate</code> Maximum uncertainty accepted for measurement
dates, in days</li>
<li>
<code>MeasureType</code> Name of the type of measurement that should
be included. Default = NULL, all measurement type are included.</li>
<li>
<code>type</code> Either ‘weight’ or ‘length’.</li>
</ul>
<p>The function returns a list including: * The data frame including
selected measures, plus individual birth date and individual age at each
measure * A summary with the number of individuals and weight: -
NInd_raw and, NWeight_raw indicate the number of unique individuals and
the number of weights once the sex, the birth type, the measurment type
from global collection have been selected - NWeight_val and NInd_val
indicate the number of unique individuals and the number of weights once
valid measurment from Husbandry have been selected - If no data are
selected, an error and its number (Nerr) are returned: The possibility
for this functions are: 1/No raw data and 2/No valid weight measure.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">core</span><span class="op">)</span></span>
<span><span class="va">data_weights</span><span class="op">=</span> <span class="fu"><a href="../reference/Gro_cleanmeasures.html">Gro_cleanmeasures</a></span><span class="op">(</span><span class="va">weights</span>, <span class="va">core</span>,</span>
<span>                                BirthType <span class="op">=</span> <span class="st">"All"</span>,</span>
<span>                                MeasureType <span class="op">=</span> <span class="st">'Live weight'</span>,</span>
<span>                                MinDate <span class="op">=</span> <span class="st">"1980-01-01"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gro_remoutliers">gro_remoutliers<a class="anchor" aria-label="anchor" href="#gro_remoutliers"></a>
</h2>
<p>This function removes the outliers from a dataset of weights. This
function takes as arguments:
<code>*</code>data_weight<code>a data frame that must include at least the columns</code>MeasurementValue<code>,</code>MeasurementType<code>, and</code>Age<code>. *</code>Taxa<code>the name of the taxa studied *</code>AgeMat<code>the MINIMUM age at sexual maturity. The function takes as threshold 1.2*AgeMat to differentiate juveniles (still growing) from adults *</code>maxweight<code>*</code>variableid<code>name of the column including individual IDs. Defaut = "AnimalAnonID". It must also be a column of</code>data_weight<code>*</code>minq<code>Sensitivity of the function to remove outliers using percentiles, between 0 and 1. Default =  0.025 *</code>IQR<code>influences the sensitivity of the function to remove outliers using generalized additive model of growth. It should be above 1 Default =  2.75. A higher number makes the function less sensitive to find outliers. *</code>perc_weight_min<code>Minimum percentage of weight that an individual can naturally lose or gain during a year . Default =  0.2 (20%) *</code>perc_weight_max`
Maximum percentage of weight that an individual can naturally lose or
gain during a year . Default = 2.5 (250%)</p>
<p>This function follow 4 different steps to highlight outliers: 1/ It
removes the measures higher than the argument <code>maxweight</code>
(Instead of using the OrdMag Fernando that was removing only very
extreme values, a maximum value was set for each taxa). In the default
case, default values are in kilograms and are set at 7000kg for
Mammalia, 200kg for Aves, 1500kg for Reptilia, 100kg for Amphibia,
1000kg for Chondrichthyes and 500kg for Osteichthyes. 2/ Independently
on adults and juveniles, it uses the function Gro_Rout_quan() to removes
outliers based on percentiles on adults and juveniles. It uses sliding
windows of age for juveniles. You can choose the number of intervals
used for the sliding windows using the argument
<code>Ninterval_juv</code>. 3/ Independently on adults and juveniles, it
uses the function Gro_lin_ind() to build generalized additive models for
each individual trajectories with at least <code>min_Nmeasures</code>
measures and remove outliers based on the residuals of the models. 4/ It
uses the function Gro_lin_ind() to build a common generalized additive
model for all growth trajectories and remove outliers based on the
residuals of the models.</p>
<p>The function returns the data frame including the column
<code>KEEP</code> a numeric vector of 1 and 0 indicating the measures to
keep. The 0 signal outliers. Other additional columns keep1, keep2,
keep3 indicates the individuals highlighted as outliers (0) in steps 1
to 3, and the column juv indicates which individuals have been
classified as juveniles.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="va">weights</span> <span class="op">=</span> <span class="fu"><a href="../reference/Gro_remoutliers.html">Gro_remoutliers</a></span><span class="op">(</span><span class="va">weights</span><span class="op">[</span><span class="va">weights</span><span class="op">$</span><span class="va">MeasurementType</span> <span class="op">==</span> <span class="st">"Live weight"</span>,<span class="op">]</span>, </span>
<span>                          Taxa <span class="op">=</span> <span class="st">"Mammalia"</span>, AgeMat <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in Gro_remoutliers(weights[weights$MeasurementType == "Live weight", :</span></span>
<span><span class="co">#&gt; Multiple measurment types found in the data: Live weight, Data should often</span></span>
<span><span class="co">#&gt; include only one Measurement Type</span></span></code></pre></div>
<div class="section level3">
<h3 id="remove-outliers-from-percentiles">Remove outliers from percentiles<a class="anchor" aria-label="anchor" href="#remove-outliers-from-percentiles"></a>
</h3>
<p>This functions removes all values lower and higher than the median
value multiplied by how many times the (100-q)th percentile is higher
than the qth percentile of the distribution of weights. This function
does not remove the 2 youngest and 2 oldest individuals.</p>
<p>The measurement values must be positive</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">40</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">103</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Gro_Rout_quan.html">Gro_Rout_quan</a></span> <span class="op">(</span><span class="va">z</span>,<span class="va">x</span>, minq <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt;  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="linearize-individual-trajectories">Linearize individual trajectories<a class="anchor" aria-label="anchor" href="#linearize-individual-trajectories"></a>
</h3>
<p>This function takes as arguments:</p>
<ul>
<li>
<code>data_weight</code> a data frame that must include at least the
columns <code>MeasurementValue</code> and <code>Age</code>and
<code>AnimalAnonID</code>
</li>
<li>
<code>perc_weight_min</code> Minimum percentage of weight that an
individual can naturally lose or gain during a year. Default = 0.2
(20%)</li>
<li>
<code>perc_weight_max</code> Maximum percentage of weight that an
individual can naturally lose or gain during a year. Default = 2.5
(250%). This value is used only after 1 year old</li>
<li>
<code>IQR</code> influences the sensitivity of the function to
remove outliers. It should be above 1 Default = 1.5. A higher number
makes the function less sensitive to find outliers.</li>
<li>
<code>remove_ext</code> Do you want to keep the two first and two
last observations of individual trajectories? These points may often be
highlighted as false outliers. Default = TRUE</li>
<li>
<code>traj_ind</code> Do you want to build a model at the level of
the individual trajectory Default = TRUE. If yes, each individual
trajectory must have at least 5 measures.</li>
</ul>
<p>The function uses build generalized additive model of the measurement
value in relation to age. It flags as outliers all measures for which
the residuals from the linear model are above IQR * the inter quantile
interval (quantile(0.9) - quantile(0.1)) of the residuals.
<code>perc_weight_min</code> and <code>perc_weight_max</code> limit the
values that must be considered as outliers.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#We use only trajectories for which the number of individual datapoints is &gt; 6</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">AnimalAnonID</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>nb<span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nb</span> <span class="op">&gt;</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weights_ind</span> <span class="op">&lt;-</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="../reference/Gro_lin_ind.html">Gro_lin_ind</a></span><span class="op">(</span>traj_ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">weights_ind</span><span class="op">$</span><span class="va">Keep2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    [1] 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;   [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;   [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [112] 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [223] 0 0 0 0 0 0 0 1 1 0 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [260] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [297] 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [334] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [371] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [408] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [445] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [482] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [519] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [556] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [593] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [630] 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 1 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [667] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [704] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [741] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 1 1 1 1 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [778] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [815] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [852] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [889] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [926] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt;  [963] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1000] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1037] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1074] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1111] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1148] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1185] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1222] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1259] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1296] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1333] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1370] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1407] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1444] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1481] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1518] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1555] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1592] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1629] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1666] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1703] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1740] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1777] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1814] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1851] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1888] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1925] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1962] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [1999] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [2036] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></span>
<span><span class="co">#&gt; [2073] 0 0 0</span></span>
<span></span>
<span><span class="va">weights_pop</span> <span class="op">&lt;-</span> <span class="va">weights</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="../reference/Gro_lin_ind.html">Gro_lin_ind</a></span><span class="op">(</span>traj_ind <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-outliers">Plot outliers<a class="anchor" aria-label="anchor" href="#plot-outliers"></a>
</h3>
<p>This function makes a plot higlighting the outliers found by
Gro_remoutliers()). It takes as arguments:</p>
<ul>
<li>data output from Gro_remoutliers() including at least the numeric
columns <em>Age</em>, <em>MeasurementValue</em>, <em>keep1</em>,
<em>keep2</em>, <em>keep3</em>, and <em>KEEP</em>
</li>
<li>title of the plot</li>
<li>xlimit: min and max for the x axis</li>
<li>ylimit: min and max for the y axis</li>
</ul>
<p>The plot of the data points showed the outliers : * in red if
detected using the maximum possible value * in green if detected using
the inter quartile range * in cyan if detected using individual
trajectories * in blue if detected from the global log-linear model</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="va">weights</span> <span class="op">=</span> <span class="fu"><a href="../reference/Gro_remoutliers.html">Gro_remoutliers</a></span><span class="op">(</span><span class="va">weights</span><span class="op">[</span><span class="va">weights</span><span class="op">$</span><span class="va">MeasurementType</span> <span class="op">==</span> <span class="st">"Live weight"</span>,<span class="op">]</span>, </span>
<span>                          Taxa <span class="op">=</span> <span class="st">"Reptilia"</span>, AgeMat <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in Gro_remoutliers(weights[weights$MeasurementType == "Live weight", :</span></span>
<span><span class="co">#&gt; Multiple measurment types found in the data: Live weight, Data should often</span></span>
<span><span class="co">#&gt; include only one Measurement Type</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gro_outplot.html">Gro_outplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">weights</span>, </span>
<span>                 title <span class="op">=</span> <span class="st">"Species A"</span>, ylimit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="growth_files/figure-html/example-Gro_outplot-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="growth-model">Growth model<a class="anchor" aria-label="anchor" href="#growth-model"></a>
</h2>
<div class="section level3">
<h3 id="growth-analysis">Growth analysis<a class="anchor" aria-label="anchor" href="#growth-analysis"></a>
</h3>
<p>This function fit a serie of growth models to a dataset, select the
best one by AIC and estimates the percentiles of the predicted
distribution of values. It takes as arguments:</p>
<ul>
<li>data_weight including at least the numeric columns <em>Age</em>,
<em>MeasurementValue</em> and <em>AnimalAnonID</em>
</li>
<li>all_mods indicating the growth models that need to be fit.The
following models are supported : logistic, gompertz, chapmanRichards,
vonBertalanffy, polynomial. default = “vonBertalanffy”</li>
<li>percentiles indicating the percentiles that need to be estimated.
default = c(2.5,97.5) corresponding to the 95% predicted interval.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">AnimalAnonID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">MeasurementValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">+</span><span class="fl">15</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Age</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span> <span class="va">AnimalAnonID</span><span class="op">*</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> </span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="va">Age</span>, MeasurementValue <span class="op">=</span> <span class="va">MeasurementValue</span>, </span>
<span>                 AnimalAnonID <span class="op">=</span> <span class="va">AnimalAnonID</span>, MeasurementType <span class="op">=</span> <span class="st">"Live Weight"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/Gro_analysis.html">Gro_analysis</a></span><span class="op">(</span><span class="va">dat</span>, </span>
<span>                   all_mods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logistic"</span>, <span class="st">"vonBertalanffy"</span>, <span class="st">"gam"</span><span class="op">)</span>, </span>
<span>                   percentiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">97.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-growth-model">Fit growth model<a class="anchor" aria-label="anchor" href="#fit-growth-model"></a>
</h3>
<p>This function fits a given growth model to a dataset. It takes as
arguments:</p>
<ul>
<li>num index of the model to run</li>
<li>
<code>data</code>, a data frame including at least the numeric
columns <em>logx</em> and <em>logz</em>
</li>
<li>
<code>model</code> Name of the model to fit. The following models
are supported : logistic, gompertz, chapmanRichards, vonBertalanffy,
polynomial</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">logz</span> <span class="op">&lt;-</span> <span class="fl">0.2</span><span class="op">+</span> <span class="fl">15</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">logx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>logx <span class="op">=</span> <span class="va">logx</span>, logz <span class="op">=</span> <span class="va">logz</span>,AnimalAnonID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gro_fitlog.html">Gro_fitlog</a></span><span class="op">(</span>num <span class="op">=</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dat</span>, all_mods <span class="op">=</span> <span class="st">"vonBertalanffy"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="growth-model-setting">Growth Model Setting<a class="anchor" aria-label="anchor" href="#growth-model-setting"></a>
</h3>
<p>This function gets the parameter and equations for the growth model
and takes as arguments:</p>
<ul>
<li>
<code>data</code>, a data frame including at least the numeric
columns <em>logx</em> and <em>logz</em>
</li>
<li>
<code>model</code> Name of the model to fit. The following models
are supported : logistic, gompertz, chapmanRichards, vonBertalanffy,
polynomial</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">logz</span> <span class="op">&lt;-</span> <span class="fl">0.2</span><span class="op">+</span> <span class="fl">15</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">logx</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>logx <span class="op">=</span> <span class="va">logx</span>, logz <span class="op">=</span> <span class="va">logz</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Gro_ModSettings.html">Gro_ModSettings</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, model <span class="op">=</span> <span class="st">"vonBertalanffy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $growthMod</span></span>
<span><span class="co">#&gt; function(gamma = 0.5 , zinf = 0, z0 = 0, LL = F, logx, logz = 0) {</span></span>
<span><span class="co">#&gt;   zEst &lt;-z0 + zinf * (1 - exp(- gamma * logx))</span></span>
<span><span class="co">#&gt;   if(LL){</span></span>
<span><span class="co">#&gt;     return(sum((logz - zEst)^2))</span></span>
<span><span class="co">#&gt;   }else{return(zEst)}</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x00000146a333d160&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:ISRverse&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $np</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $namesCoef</span></span>
<span><span class="co">#&gt; [1] "z0"    "zinf"  "gamma"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $low</span></span>
<span><span class="co">#&gt; [1] 0 0 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gamstart</span></span>
<span><span class="co">#&gt; $gamstart$zinf</span></span>
<span><span class="co">#&gt; [1] 243.7833</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gamstart$z0</span></span>
<span><span class="co">#&gt; [1] -229.4045</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gamstart$gamma</span></span>
<span><span class="co">#&gt; [1] 1.005333</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-model-prediction">Plot model prediction<a class="anchor" aria-label="anchor" href="#plot-model-prediction"></a>
</h3>
<p>This function makes a plot of the predicted percentiles from a growth
model with data points. It takes as arguments:</p>
<ul>
<li>data including at least the numeric columns <em>Age</em>,
<em>MeasurementValue</em> and <em>AnimalAnonID</em>
</li>
<li>data_percent including the predicted percentile from the growth
model and the numeric columns <em>Age</em>, <em>percentiles50</em> and
other percentiles to plot.</li>
<li>title of the plot</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">AnimalAnonID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">MeasurementValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">+</span><span class="fl">15</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Age</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span> <span class="va">AnimalAnonID</span><span class="op">*</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> </span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="va">Age</span>, MeasurementValue <span class="op">=</span> <span class="va">MeasurementValue</span>, </span>
<span>                 AnimalAnonID <span class="op">=</span> <span class="va">AnimalAnonID</span>, MeasurementType <span class="op">=</span> <span class="st">"Live Weight"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/Gro_analysis.html">Gro_analysis</a></span><span class="op">(</span><span class="va">dat</span>, </span>
<span>                   all_mods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logistic"</span>, <span class="st">"vonBertalanffy"</span>, <span class="st">"gam"</span><span class="op">)</span>, </span>
<span>                   percentiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">97.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gro_plot.html">Gro_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, </span>
<span>              data_percent <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">percent</span>, </span>
<span>              title <span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">AIC_tab</span><span class="op">$</span><span class="va">model</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="growth_files/figure-html/example-Gro_plot-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Floriane Plard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

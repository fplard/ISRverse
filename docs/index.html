<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Run ISR Analyses For Taxon Profiles • ISRverse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Run ISR Analyses For Taxon Profiles">
<meta property="og:description" content="Survival, Reproduction and Growth analyses.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ISRverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/data-selection.html">Data Selection</a>
    </li>
    <li>
      <a href="articles/growth.html">Growth</a>
    </li>
    <li>
      <a href="articles/reproduction.html">Reproduction</a>
    </li>
    <li>
      <a href="articles/survival.html">Survival</a>
    </li>
    <li>
      <a href="articles/taxon-profiles.html">Taxon profiles</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="isrverse">ISRverse<a class="anchor" aria-label="anchor" href="#isrverse"></a>
</h1></div>
<!-- badges: start -->

<p>ISRverse can be used to run taxon profiles for Species360. It proposes tools to :</p>
<ul>
<li>Load Zims data</li>
<li>Run the main demographic analyses: survival, reproduction and growth models</li>
<li>Run the taxon profile analyses</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>First you will need install paramDemo on your computer from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="co"># library(devtools)</span></span>
<span><span class="fu">install_git</span><span class="op">(</span><span class="st">"https://github.com/fercol/paramDemo"</span>, subdir <span class="op">=</span> <span class="st">"pkg/"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of ISRverse from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"fplard/ISRverse"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>Full documentation website on: <a href="https://fplard.github.io/ISRverse" class="external-link uri">https://fplard.github.io/ISRverse</a></p>
<p>You can also open the documentation locally on your machine using</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"docs"</span>, <span class="st">"index.html"</span>, package <span class="op">=</span> <span class="st">"ISRverse"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/browseURL.html" class="external-link">browseURL</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-up-your-rstudio-environnement">Set up your Rstudio environnement<a class="anchor" aria-label="anchor" href="#set-up-your-rstudio-environnement"></a>
</h2>
<p>Use the correct directories to find data and run the analyses</p>
<div class="section level4">
<h4 id="on-your-own-computer">On your own computer<a class="anchor" aria-label="anchor" href="#on-your-own-computer"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Path to the ZIMSdata directory:</span></span>
<span><span class="va">ZIMSdir</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/flopy/Documents/ISR/TaxonProfiles/"</span></span>
<span></span>
<span><span class="va">ZIMSdirdata</span> <span class="op">&lt;-</span> <span class="fu">glue</span> <span class="op">(</span><span class="st">"{ZIMSdir}Data"</span><span class="op">)</span></span>
<span><span class="va">analysisDir</span> <span class="op">&lt;-</span> <span class="fu">glue</span> <span class="op">(</span><span class="st">"{ZIMSdir}Analyses/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># directory to save Rdata:</span></span>
<span><span class="va">RdataDir</span> <span class="op">&lt;-</span>  <span class="fu">glue</span> <span class="op">(</span><span class="st">"{analysisDir}Rdata/"</span><span class="op">)</span></span>
<span><span class="co"># directory to save Json for the dev team:</span></span>
<span><span class="va">JsonDir</span> <span class="op">&lt;-</span>  <span class="fu">glue</span> <span class="op">(</span><span class="st">"{analysisDir}Json/"</span><span class="op">)</span></span>
<span><span class="co"># Plot directory:</span></span>
<span><span class="va">plotDir</span> <span class="op">&lt;-</span> <span class="fu">glue</span> <span class="op">(</span><span class="st">"{analysisDir}Plot/"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">analysisDir</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="on-ucloud">On Ucloud<a class="anchor" aria-label="anchor" href="#on-ucloud"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Install libraries:</span></span>
<span><span class="va">instPacks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"snowfall"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"snowfall"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"rjson"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rjson"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"ggpubr"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggpubr"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"bbmle"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"bbmle"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"BasTA"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BaSTA"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"assertthat"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"assertthat"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"glue"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"glue"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"checkmate"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"checkmate"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"paramDemo"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"/work/Species360/Rpackages/latestVersion/paramDemo_1.0.0.tar.gz"</span>,</span>
<span>                   type <span class="op">=</span> <span class="st">"source"</span>, repos <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"ISRverse"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">instPacks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"/work/Species360/Rpackages/latestVersion/ISRverse_0.0.0.9000.tar.gz"</span>, </span>
<span>                   type <span class="op">=</span> <span class="st">"source"</span>, repos <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/" class="external-link">glue</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ZIMS directory where to find data:</span></span>
<span><span class="va">ZIMSdirdata</span> <span class="op">&lt;-</span> <span class="st">"/work/Species360/ZIMSdata_ext240829"</span></span>
<span></span>
<span><span class="co"># General directory:</span></span>
<span><span class="va">analysisDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span> <span class="op">(</span><span class="st">"/work/Species360/Demo_Analyses/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># directory to save Rdata:</span></span>
<span><span class="va">RdataDir</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span> <span class="op">(</span><span class="st">"{analysisDir}Rdata/"</span><span class="op">)</span></span>
<span><span class="co"># directory to save Json for the dev team:</span></span>
<span><span class="va">JsonDir</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span> <span class="op">(</span><span class="st">"{analysisDir}Json/"</span><span class="op">)</span></span>
<span><span class="co"># Plot directory:</span></span>
<span><span class="va">plotDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span> <span class="op">(</span><span class="st">"{analysisDir}Plot/"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="libraries">Libraries<a class="anchor" aria-label="anchor" href="#libraries"></a>
</h3>
<p>Download the needed libraries</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ISRverse</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexcb/rjson" class="external-link">rjson</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="split-science-extract-per-taxa">Split Science extract per taxa<a class="anchor" aria-label="anchor" href="#split-science-extract-per-taxa"></a>
</h2>
<p>DO NOT DO THAT IN MOST CASES</p>
<p>To be done !!!!!ONLY ONCE!!!! after the download of the science extract. This function will load the science extract and: * split it by taxa * select only “Individual” for Animal Type * add binSpecies name * weights and lengths: check that measurement are &gt; 0, add the following columns: Age in years, UnitOfMeasure and MeasurementValue</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Path to the ZIMSdata directory:</span></span>
<span><span class="va">extractDate</span> <span class="op">=</span><span class="st">"2024-08-29"</span></span>
<span><span class="fu"><a href="reference/Split_Zimsdata.html">Split_Zimsdata</a></span>  <span class="op">(</span>ZIMSdir <span class="op">=</span> <span class="va">ZIMSdirdata</span>, extractDate <span class="op">=</span> <span class="va">extractDate</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tutorial-for-reproduction">Tutorial for reproduction<a class="anchor" aria-label="anchor" href="#tutorial-for-reproduction"></a>
</h2>
<div class="section level3">
<h3 id="litter-size">Litter size<a class="anchor" aria-label="anchor" href="#litter-size"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extractDate</span> <span class="op">=</span><span class="st">"2024-08-29"</span></span>
<span><span class="va">minDate</span> <span class="op">=</span> <span class="st">"1980-01-01"</span></span>
<span><span class="va">Global</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="va">taxa</span> <span class="op">=</span> <span class="st">"Mammalia"</span></span>
<span><span class="va">List_species</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Mammalia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Panthera leo"</span>, <span class="st">"Panthera onca"</span>,<span class="st">"Panthera uncia"</span>, <span class="st">"Panthera tigris"</span>, <span class="st">"Panthera pardus"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conditions to run the reproduction analyses</span></span>
<span><span class="va">uncert_birth</span> <span class="op">=</span> <span class="fl">365</span>  <span class="co">#Maximum uncertainty accepted for birth dates, in days</span></span>
<span><span class="va">minNrepro</span> <span class="op">=</span> <span class="fl">100</span>   <span class="co">#Minimum number of birth records</span></span>
<span><span class="va">minNparepro</span> <span class="op">=</span> <span class="fl">30</span>  <span class="co">#Minimum number of unique parent records</span></span>
<span><span class="va">minNlitter</span> <span class="op">=</span> <span class="fl">30</span> <span class="co">#Minimum number of litter sizes</span></span>
<span><span class="va">parentProb</span> <span class="op">=</span> <span class="fl">80</span> <span class="co">#Minimum parentage probability</span></span>
<span><span class="va">Nday</span> <span class="op">=</span> <span class="fl">7</span>  <span class="co">#Group all offspring born within this interval of days in one litter</span></span>
<span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Load_Zimsdata.html">Load_Zimsdata</a></span><span class="op">(</span>taxa <span class="op">=</span> <span class="va">taxa</span>, ZIMSdir <span class="op">=</span> <span class="va">ZIMSdirdata</span>, </span>
<span>                      species <span class="op">=</span> <span class="va">List_species</span>,</span>
<span>                      Animal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      tables<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Collection'</span>, <span class="st">'Parent'</span>, <span class="st">'Move'</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Animal</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Prep_Animal.html">Prep_Animal</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Animal</span>, extractDate <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="st">"2024/08/29"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TAB</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">species</span> <span class="kw">in</span> <span class="va">List_species</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span>
<span>  <span class="va">Dataspe</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/select_species.html">select_species</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">Animal</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Collection</span>, uncert_birth <span class="op">=</span> <span class="va">uncert_birth</span>,</span>
<span>                            minDate <span class="op">=</span> <span class="va">minDate</span> , extractDate <span class="op">=</span> <span class="va">extractDate</span>,</span>
<span>                            Global <span class="op">=</span> <span class="va">Global</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="co">#prepare Reproduction data</span></span>
<span>  <span class="va">Datarep</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Rep_prepdata.html">Rep_prepdata</a></span><span class="op">(</span>coresubset <span class="op">=</span>   <span class="va">Dataspe</span><span class="op">$</span><span class="va">data</span>, </span>
<span>                          <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Collection</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Parent</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Move</span>,</span>
<span>                          BirthType_parent <span class="op">=</span> <span class="st">"Captive"</span>, BirthType_offspring <span class="op">=</span> <span class="st">"Captive"</span>,</span>
<span>                          minNrep<span class="op">=</span><span class="va">minNrepro</span>, minNparep <span class="op">=</span><span class="va">minNparepro</span>, Global <span class="op">=</span> <span class="va">Global</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Datarep</span><span class="op">$</span><span class="va">Reprodata</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co">#Litter sizes</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Rep_littersize.html">Rep_littersize</a></span><span class="op">(</span><span class="va">Datarep</span><span class="op">$</span><span class="va">Reprodata</span>, perAge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          Nday <span class="op">=</span> <span class="va">Nday</span>, parentProb <span class="op">=</span> <span class="va">parentProb</span>,  minNlitter <span class="op">=</span><span class="va">minNlitter</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">df</span> <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">littSizeDf</span><span class="op"><a href="reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Species <span class="op">=</span> <span class="va">species</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">TAB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">TAB</span>, <span class="va">df</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">TAB</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="age-at-first-reproduction">Age at first reproduction<a class="anchor" aria-label="anchor" href="#age-at-first-reproduction"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extractDate</span> <span class="op">=</span><span class="st">"2024-08-29"</span></span>
<span><span class="va">minDate</span> <span class="op">=</span> <span class="st">"1980-01-01"</span></span>
<span><span class="va">Global</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span></span>
<span><span class="va">taxa</span> <span class="op">=</span> <span class="st">"Mammalia"</span></span>
<span><span class="va">List_species</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Mammalia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Panthera leo"</span>, <span class="st">"Alces alces"</span>,<span class="st">"Lasiurus cinereus"</span>, <span class="st">"Gorilla gorilla"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conditions to run the reproduction analyses</span></span>
<span><span class="va">uncert_birth</span> <span class="op">=</span> <span class="fl">365</span>  <span class="co">#Maximum uncertainty accepted for birth dates, in days</span></span>
<span><span class="va">minNrepro</span> <span class="op">=</span> <span class="fl">100</span>   <span class="co">#Minimum number of birth records</span></span>
<span><span class="va">minNparepro</span> <span class="op">=</span> <span class="fl">30</span>  <span class="co">#Minimum number of unique parent records</span></span>
<span></span>
<span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Load_Zimsdata.html">Load_Zimsdata</a></span><span class="op">(</span>taxa <span class="op">=</span> <span class="va">taxa</span>, ZIMSdir <span class="op">=</span> <span class="va">ZIMSdirdata</span>, </span>
<span>                      species <span class="op">=</span> <span class="va">List_species</span>,</span>
<span>                      Animal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      tables<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Collection'</span>, <span class="st">'Parent'</span>, <span class="st">'Move'</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Animal</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Prep_Animal.html">Prep_Animal</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Animal</span>, extractDate <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_date</a></span><span class="op">(</span><span class="st">"2024/08/29"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TAB</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">species</span> <span class="kw">in</span> <span class="va">List_species</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span>
<span>  <span class="va">Dataspe</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/select_species.html">select_species</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">Animal</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Collection</span>, uncert_birth <span class="op">=</span> <span class="va">uncert_birth</span>,</span>
<span>                            minDate <span class="op">=</span> <span class="va">minDate</span> , extractDate <span class="op">=</span> <span class="va">extractDate</span>,</span>
<span>                            Global <span class="op">=</span> <span class="va">Global</span><span class="op">)</span> </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Dataspe</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">sx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"All"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sx</span><span class="op">)</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">sx</span> <span class="op">!=</span> <span class="st">"All"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">coresubset</span> <span class="op">&lt;-</span> <span class="va">Dataspe</span><span class="op">$</span><span class="va">data</span><span class="op"><a href="reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SexType</span> <span class="op">==</span> <span class="va">sx</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="va">coresubset</span> <span class="op">&lt;-</span> <span class="va">Dataspe</span><span class="op">$</span><span class="va">data</span><span class="op">}</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coresubset</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co">#prepare Reproduction data</span></span>
<span>        <span class="va">Datarep</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Rep_prepdata.html">Rep_prepdata</a></span><span class="op">(</span>coresubset <span class="op">=</span> <span class="va">coresubset</span>, </span>
<span>                                <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Collection</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Parent</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Move</span>,</span>
<span>                                BirthType_parent <span class="op">=</span> <span class="st">"Captive"</span>, BirthType_offspring <span class="op">=</span> <span class="st">"Captive"</span>,</span>
<span>                                minNrep<span class="op">=</span><span class="va">minNrepro</span>, minNparep <span class="op">=</span><span class="va">minNparepro</span>, Global <span class="op">=</span> <span class="va">Global</span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Datarep</span><span class="op">$</span><span class="va">Reprodata</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="co">#Calculate reproductive age statistics</span></span>
<span>          <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Rep_agemat.html">Rep_agemat</a></span><span class="op">(</span><span class="va">Datarep</span><span class="op">$</span><span class="va">Reprodata</span><span class="op">)</span><span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Species <span class="op">=</span> <span class="va">species</span>,</span>
<span>                   Class <span class="op">=</span> <span class="va">taxa</span>,</span>
<span>                   Sex <span class="op">=</span> <span class="va">sx</span><span class="op">)</span></span>
<span>          </span>
<span>          <span class="va">TAB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">TAB</span>, <span class="va">out</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">TAB</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="tutorial-for-growth">Tutorial for growth<a class="anchor" aria-label="anchor" href="#tutorial-for-growth"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Directory where to save results</span></span>
<span><span class="va">SaveDir</span> <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span> <span class="op">(</span><span class="st">"{analysisDir}savegrowth"</span><span class="op">)</span></span>
<span><span class="va">PlotDir</span> <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span> <span class="op">(</span><span class="st">"{analysisDir}plotgrowth"</span><span class="op">)</span></span>
<span><span class="va">extractDate</span> <span class="op">=</span><span class="st">"2024-08-29"</span></span>
<span></span>
<span></span>
<span><span class="va">taxa</span> <span class="op">=</span> <span class="st">"Mammalia"</span></span>
<span><span class="va">List_species</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Mammalia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Panthera leo"</span>, <span class="st">"Panthera onca"</span>,<span class="st">"Panthera uncia"</span>, <span class="st">"Panthera tigris"</span>, <span class="st">"Panthera pardus"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sexCats</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"All"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Filters</span></span>
<span><span class="co"># Earliest date to include records</span></span>
<span><span class="va">minDate</span> <span class="op">&lt;-</span> <span class="st">"1980-01-01"</span></span>
<span><span class="co"># Earliest birth date to include records</span></span>
<span><span class="va">minBirthDate</span> <span class="op">&lt;-</span> <span class="st">"1900-01-01"</span></span>
<span><span class="co">#Whether to include only Global individuals</span></span>
<span><span class="va">Global</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="co">#Birth Type of Animals: "Captive", "Wild" or "All"</span></span>
<span><span class="va">Birth_Type</span> <span class="op">=</span> <span class="st">"Captive"</span></span>
<span><span class="co"># Maximum threshold in the longevity distribution to use</span></span>
<span><span class="va">maxOutl</span> <span class="op">&lt;-</span> <span class="fl">99</span> </span>
<span><span class="co">#Maximum uncertainty accepted for birth dates, in days</span></span>
<span><span class="va">uncert_birth</span> <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="co">#Maximum uncertainty accepted for measurement dates: weight, in days</span></span>
<span><span class="va">uncert_date</span> <span class="op">=</span> <span class="fl">365</span></span>
<span></span>
<span></span>
<span><span class="co">#Models: "logistic", "gompertz", "chapmanRichards", "vonBertalanffy", "gam", and/or "polynomial"</span></span>
<span><span class="va">models_gro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vonBertalanffy"</span>, <span class="st">"gompertz"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Measure type to select</span></span>
<span><span class="va">MeasureType</span> <span class="op">=</span> <span class="st">"Live weight"</span></span>
<span></span>
<span><span class="co"># Conditions to run the growth analysis</span></span>
<span><span class="va">minNgro</span> <span class="op">=</span> <span class="fl">100</span> <span class="co">#Minimum number of weights</span></span>
<span><span class="va">minNIgro</span> <span class="op">=</span> <span class="fl">50</span> <span class="co">#Minimum number of individuals</span></span>
<span></span>
<span></span>
<span><span class="co"># Conditions to estimate age at sexual maturity</span></span>
<span><span class="va">minNrepro</span> <span class="op">=</span> <span class="fl">100</span>   <span class="co">#Minimum number of birth records</span></span>
<span><span class="va">minNparepro</span> <span class="op">=</span> <span class="fl">30</span>  <span class="co">#Minimum number of unique parent records</span></span>
<span></span>
<span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Load_Zimsdata.html">Load_Zimsdata</a></span><span class="op">(</span>taxa <span class="op">=</span> <span class="va">taxa</span>, ZIMSdir <span class="op">=</span> <span class="va">ZIMSdirdata</span>, </span>
<span>                      species <span class="op">=</span> <span class="va">List_species</span>,</span>
<span>                      Animal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      tables<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Collection'</span>, <span class="st">"Weight"</span>, <span class="st">'Parent'</span>, <span class="st">'Move'</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Animal</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Prep_Animal.html">Prep_Animal</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Animal</span>, extractDate <span class="op">=</span> <span class="va">extractDate</span>, minBirthDate <span class="op">=</span><span class="va">minBirthDate</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">species</span> <span class="kw">in</span> <span class="va">List_species</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span>
<span>  <span class="va">Dataspe</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/select_species.html">select_species</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">Animal</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Collection</span>, uncert_birth <span class="op">=</span> <span class="va">uncert_birth</span>,</span>
<span>                            minDate <span class="op">=</span> <span class="va">minDate</span> , extractDate <span class="op">=</span> <span class="va">extractDate</span>,</span>
<span>                            Global <span class="op">=</span> <span class="va">Global</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Dataspe</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">repr</span> <span class="op">=</span> <span class="va">weig</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">sx</span> <span class="kw">in</span> <span class="va">sexCats</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">" ****************************  "</span>,<span class="va">sx</span>,<span class="st">"  ****************************\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="co">#Let's see later if we need to set a threshold for the longevity distribution</span></span>
<span>      <span class="co"># sexDat &lt;- select_Longthreshold( Dataspe$data,  sexCats = sx, </span></span>
<span>      <span class="co">#                                 PlotDir= PlotDir, minN = minN,</span></span>
<span>      <span class="co">#                                 maintitle = glue::glue("{species}_{sx}") )</span></span>
<span>       <span class="kw">if</span><span class="op">(</span><span class="va">sx</span> <span class="op">!=</span> <span class="st">"All"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">coresubset</span> <span class="op">&lt;-</span> <span class="va">Dataspe</span><span class="op">$</span><span class="va">data</span><span class="op"><a href="reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SexType</span> <span class="op">==</span> <span class="va">sx</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="va">coresubset</span> <span class="op">&lt;-</span> <span class="va">Dataspe</span><span class="op">$</span><span class="va">data</span><span class="op">}</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coresubset</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co">#Estimate age at sexual maturity</span></span>
<span>        <span class="va">repr</span><span class="op">[[</span><span class="va">sx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Rep_main.html">Rep_main</a></span><span class="op">(</span>coresubset<span class="op">=</span> <span class="va">coresubset</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Collection</span>, </span>
<span>                               <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Parent</span>, <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Move</span>,  </span>
<span>                               Repsect <span class="op">=</span> <span class="st">"agemat"</span>,</span>
<span>                               BirthType_parent <span class="op">=</span> <span class="va">Birth_Type</span>, BirthType_offspring <span class="op">=</span> <span class="va">Birth_Type</span>, </span>
<span>                               Global <span class="op">=</span> <span class="va">Global</span>, </span>
<span>                               minNrepro <span class="op">=</span> <span class="va">minNrepro</span>, minNparepro <span class="op">=</span>  <span class="va">minNparepro</span></span>
<span>        <span class="op">)</span></span>
<span>        </span>
<span>        <span class="va">agemat</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">repr</span><span class="op">[[</span><span class="va">sx</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">repr</span><span class="op">[[</span><span class="va">sx</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">amat_analyzed</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">agemat</span> <span class="op">=</span><span class="va">repr</span><span class="op">[[</span><span class="va">sx</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">agemat</span><span class="op">$</span><span class="va">ageMat</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>        </span>
<span>        <span class="va">weig</span><span class="op">[[</span><span class="va">sx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Gro_Main.html">Gro_Main</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Data</span><span class="op">[[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Weight</span>, coresubse <span class="op">=</span> <span class="va">coresubset</span>,</span>
<span>                               taxa <span class="op">=</span> <span class="va">taxa</span>, species <span class="op">=</span> <span class="va">species</span>,</span>
<span>                               Birth_Type <span class="op">=</span> <span class="va">Birth_Type</span>, </span>
<span>                               agemat <span class="op">=</span> <span class="va">agemat</span>, percentiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">97.5</span><span class="op">)</span>,</span>
<span>                               PlotDir <span class="op">=</span> <span class="va">PlotDir</span>, type <span class="op">=</span> <span class="st">"weight"</span>,</span>
<span>                               uncert_date <span class="op">=</span> <span class="va">uncert_date</span>,</span>
<span>                               MeasureType <span class="op">=</span> <span class="va">MeasureType</span>,</span>
<span>                               minNgro <span class="op">=</span> <span class="va">minNgro</span>, minNIgro <span class="op">=</span> <span class="va">minNIgro</span>, </span>
<span>                               models <span class="op">=</span> <span class="va">models_gro</span>,</span>
<span>                               mindate <span class="op">=</span> <span class="va">minDate</span>, plotname <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{species}_{sx}"</span><span class="op">)</span> <span class="op">)</span></span>
<span>        </span>
<span>       <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">weig</span>, file <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{SaveDir}/{species}_growth.Rdata"</span><span class="op">)</span><span class="op">)</span>   </span>
<span>  <span class="op">}</span>      </span>
<span> </span>
<span><span class="op">}</span></span>
<span><span class="co">#Look at what is in "weig" and we will work on additional code to make the analysis of several species easier to save and to compare results</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tutorial-to-run-taxon-profiles">Tutorial to run Taxon profiles<a class="anchor" aria-label="anchor" href="#tutorial-to-run-taxon-profiles"></a>
</h2>
<div class="section level3">
<h3 id="choose-important-arguments">Choose important arguments<a class="anchor" aria-label="anchor" href="#choose-important-arguments"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data --------------------------------------------</span></span>
<span><span class="va">extractDate</span> <span class="op">=</span> <span class="st">"2024-08-29"</span></span>
<span></span>
<span><span class="co"># List of taxa to analyze -------------------------</span></span>
<span><span class="va">taxaList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mammalia"</span>, <span class="st">"Aves"</span>, <span class="st">"Reptilia"</span>, <span class="st">"Amphibia"</span>, </span>
<span>              <span class="st">"Chondrichthyes"</span>, <span class="st">"Osteichthyes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sex categories ----------------------------------</span></span>
<span><span class="va">BySex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Mammalia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>, </span>
<span>              Aves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>, </span>
<span>              Reptilia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"All"</span><span class="op">)</span>, </span>
<span>              Amphibia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"All"</span><span class="op">)</span>, </span>
<span>              Chondrichthyes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"All"</span><span class="op">)</span>, </span>
<span>              Osteichthyes <span class="op">=</span> <span class="st">"All"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#Filters ----------------------------------</span></span>
<span><span class="co"># Earliest date to include records</span></span>
<span><span class="va">minDate</span> <span class="op">&lt;-</span> <span class="st">"1980-01-01"</span></span>
<span><span class="co"># Earliest birth date to include records</span></span>
<span><span class="va">minBirthDate</span> <span class="op">&lt;-</span> <span class="st">"1900-01-01"</span></span>
<span><span class="co">#Whether to include only Global individuals</span></span>
<span><span class="va">Global</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="co">#Birth Type of Animals: "Captive", "Wild" or "All"</span></span>
<span><span class="va">Birth_Type</span> <span class="op">=</span> <span class="st">"Captive"</span></span>
<span><span class="co"># Minimum number of individuals to run the taxon profile</span></span>
<span><span class="va">minN</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="co"># Maximum threshold in the longevity distribution to use</span></span>
<span><span class="va">maxOutl</span> <span class="op">&lt;-</span> <span class="fl">99</span> </span>
<span><span class="co"># Conditions to run all analyses</span></span>
<span><span class="va">minInstitution</span> <span class="op">=</span> <span class="fl">2</span> </span>
<span><span class="co">#Maximum uncertainty accepted for birth dates, in days</span></span>
<span><span class="va">uncert_birth</span> <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="co">#Maximum uncertainty accepted for death dates, in days</span></span>
<span><span class="va">uncert_death</span> <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="co">#Maximum uncertainty accepted for measurement dates: weight, in days</span></span>
<span><span class="va">uncert_date</span> <span class="op">=</span> <span class="fl">365</span></span>
<span></span>
<span><span class="co"># Maximum possible age</span></span>
<span><span class="va">XMAX</span> <span class="op">=</span> <span class="fl">120</span></span>
<span></span>
<span></span>
<span><span class="co">#      Survival Models --------------------------------</span></span>
<span><span class="co"># Survival Models to run: "GO", "LO", "EX" or/and "WE"</span></span>
<span><span class="va">models_sur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GO"</span>, <span class="st">"LO"</span><span class="op">)</span></span>
<span><span class="co">#Shape of the survival model: "simple", "bathtub" or "Makeham"</span></span>
<span><span class="va">shape</span> <span class="op">=</span> <span class="st">"bathtub"</span></span>
<span></span>
<span><span class="co"># Number of CPUS:</span></span>
<span><span class="va">ncpus</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="co"># MCMC settings:</span></span>
<span><span class="va">niter</span> <span class="op">&lt;-</span> <span class="fl">25000</span></span>
<span><span class="va">burnin</span> <span class="op">&lt;-</span> <span class="fl">5001</span></span>
<span><span class="va">thinning</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">nchain</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># Conditions to run the survival analysis</span></span>
<span><span class="va">minNsur</span> <span class="op">=</span> <span class="fl">50</span> <span class="co">#Minimum number of individuals</span></span>
<span><span class="va">maxNsur</span> <span class="op">=</span> <span class="fl">1000</span> <span class="co">#Maximum number of individuals</span></span>
<span><span class="va">minlx</span> <span class="op">=</span> <span class="fl">0.1</span>  <span class="co">#Minimum survivorship reach by raw life table</span></span>
<span><span class="va">MinBirthKnown</span> <span class="op">=</span> <span class="fl">0.3</span> <span class="co">#Minimum proportions of known birth date (within a month)</span></span>
<span></span>
<span><span class="co">#Goodness of fit</span></span>
<span><span class="va">Min_MLE</span> <span class="op">=</span> <span class="fl">0.1</span> <span class="co">#Minimum survivorship at Mean life expectancy</span></span>
<span><span class="va">MaxLE</span> <span class="op">=</span> <span class="fl">2</span>     <span class="co">#Maximum remaining life expectancy at max age</span></span>
<span></span>
<span></span>
<span><span class="co">#     Reproduction Models ------------------------------</span></span>
<span><span class="co"># Reproductive Analyses to run: "agemat" or/and "litter"</span></span>
<span><span class="va">Repsect</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'agemat'</span>, <span class="st">'litter'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conditions to run the reproduction analyses</span></span>
<span><span class="va">minNrepro</span> <span class="op">=</span> <span class="fl">100</span>   <span class="co">#Minimum number of birth records</span></span>
<span><span class="va">minNparepro</span> <span class="op">=</span> <span class="fl">30</span>  <span class="co">#Minimum number of unique parent records</span></span>
<span></span>
<span><span class="co">#Litter/clutch size</span></span>
<span><span class="va">parentProb</span> <span class="op">=</span> <span class="fl">80</span> <span class="co">#Minimum percentage of parentage probability to include in litter size</span></span>
<span><span class="va">minNlitter</span> <span class="op">=</span> <span class="fl">30</span> <span class="co">#Minimum number of litters to run the analysis</span></span>
<span><span class="va">Nday</span> <span class="op">=</span> <span class="fl">7</span> <span class="co">#Number of days to group all offspring in one litter/clutch</span></span>
<span></span>
<span><span class="co">#Seasonnality</span></span>
<span><span class="va">minNseas</span> <span class="op">=</span> <span class="fl">50</span>  <span class="co">#Minimum number of births to run the seasonnality analysis</span></span>
<span></span>
<span><span class="co">#      Growth Models -----------------------------------</span></span>
<span><span class="co">#Models: "logistic", "gompertz", "chapmanRichards", "vonBertalanffy", and/or "polynomial"</span></span>
<span><span class="va">models_gro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vonBertalanffy"</span>, <span class="st">"gam"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Measure type to select</span></span>
<span><span class="va">MeasureType</span> <span class="op">=</span> <span class="st">"Live weight"</span></span>
<span></span>
<span><span class="co"># Conditions to run the growth analysis</span></span>
<span><span class="va">minNgro</span> <span class="op">=</span> <span class="fl">100</span> <span class="co">#Minimum number of weights</span></span>
<span><span class="va">minNIgro</span> <span class="op">=</span> <span class="fl">30</span> <span class="co">#Minimum number of individuals</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-inputs">Other Inputs<a class="anchor" aria-label="anchor" href="#other-inputs"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Table with species that require rerruning with higher outlier level:</span></span>
<span><span class="va">maxOutLev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{analysisDir}maxOutlierLevel.csv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">spOutLev</span> <span class="op">&lt;-</span> <span class="va">maxOutLev</span><span class="op">$</span><span class="va">Specie</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-taxon-profiles-by-taxa">Run taxon profiles by taxa<a class="anchor" aria-label="anchor" href="#run-taxon-profiles-by-taxa"></a>
</h3>
<p>You cannot run all taxa at once due to the computational resources needed. But you can choose to run per taxa (option 1) or you can also separate species for each taxa to run it in parallel on different computer (option 2)</p>
<p>For all options, you can choose which analysis to run using the argument <code>Sections</code> giving the name of the sections to run/update in the taxon profile results: “sur”, “rep” and/or “gro”</p>
<div class="section level4">
<h4 id="option-1-run-all-species-of-one-taxa">Option 1: Run all species of one taxa<a class="anchor" aria-label="anchor" href="#option-1-run-all-species-of-one-taxa"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co">#Sections to run or to update</span></span>
<span><span class="va">Sections</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sur"</span>, <span class="st">"rep"</span>, <span class="st">"gro"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/run_txprofile.html">run_txprofile</a></span> <span class="op">(</span><span class="va">taxaList</span><span class="op">[</span><span class="va">taxa</span><span class="op">]</span>, Species_list <span class="op">=</span> <span class="st">"All"</span>, <span class="va">ZIMSdirdata</span>, </span>
<span>               AnalysisDir <span class="op">=</span> <span class="va">analysisDir</span>, PlotDir <span class="op">=</span> <span class="va">plotDir</span>,</span>
<span>               Sections <span class="op">=</span> <span class="va">Sections</span>, erase_previous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               extractDate <span class="op">=</span> <span class="va">extractDate</span>, minDate <span class="op">=</span> <span class="va">minDate</span>,</span>
<span>               sexCats <span class="op">=</span> <span class="va">BySex</span><span class="op">[[</span><span class="va">taxaList</span><span class="op">[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, </span>
<span>               minN <span class="op">=</span> <span class="va">minN</span>,  Global <span class="op">=</span>  <span class="va">Global</span>,</span>
<span>               maxOutl <span class="op">=</span> <span class="va">maxOutl</span>,  spOutLev <span class="op">=</span> <span class="va">spOutLev</span>, Birth_Type <span class="op">=</span> <span class="st">"Captive"</span>, </span>
<span>               uncert_birth <span class="op">=</span> <span class="va">uncert_birth</span>, uncert_death<span class="op">=</span> <span class="va">uncert_death</span>,</span>
<span>               uncert_date <span class="op">=</span> <span class="va">uncert_date</span>,</span>
<span>               minInstitution <span class="op">=</span> <span class="va">minInstitution</span>, </span>
<span>               minNsur <span class="op">=</span> <span class="va">minNsur</span>, maxNsur <span class="op">=</span> <span class="va">maxNsur</span>, XMAX <span class="op">=</span> <span class="va">XMAX</span>,</span>
<span>               minlx <span class="op">=</span> <span class="va">minlx</span>, MinBirthKnown <span class="op">=</span> <span class="va">MinBirthKnown</span>, </span>
<span>               Min_MLE <span class="op">=</span> <span class="va">Min_MLE</span>, MaxLE <span class="op">=</span>  <span class="va">MaxLE</span>,</span>
<span>               models_sur <span class="op">=</span> <span class="va">models_sur</span>, shape <span class="op">=</span> <span class="va">shape</span>,</span>
<span>               niter <span class="op">=</span> <span class="va">niter</span>, burnin <span class="op">=</span> <span class="va">burnin</span>, thinning <span class="op">=</span> <span class="va">thinning</span>, </span>
<span>               nchain <span class="op">=</span> <span class="va">nchain</span>, ncpus <span class="op">=</span> <span class="va">ncpus</span>,</span>
<span>               parentProb <span class="op">=</span> <span class="va">parentProb</span>, minNrepro <span class="op">=</span> <span class="va">minNrepro</span>, </span>
<span>               minNparepro <span class="op">=</span> <span class="va">minNparepro</span>, minNseas <span class="op">=</span> <span class="va">minNseas</span>, </span>
<span>               minNlitter <span class="op">=</span> <span class="va">minNlitter</span>, Nday <span class="op">=</span> <span class="va">Nday</span>, </span>
<span>               minNgro <span class="op">=</span> <span class="va">minNgro</span>, minNIgro <span class="op">=</span> <span class="va">minNIgro</span>, MeasureType <span class="op">=</span> <span class="va">MeasureType</span>,</span>
<span>               models_gro <span class="op">=</span> <span class="va">models_gro</span></span>
<span>               </span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="option-2-run-one-or-a-group-of-species-from-one-taxa">Option 2: Run one or a group of species from one taxa<a class="anchor" aria-label="anchor" href="#option-2-run-one-or-a-group-of-species-from-one-taxa"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">list_surv</span><span class="op">=</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{analysisDir}Liste_Survival.xlsx"</span><span class="op">)</span>, sheet <span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">==</span> <span class="st">"Mammalia"</span><span class="op">)</span><span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op"><a href="reference/pipe.html">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co">#Sections to run or to update</span></span>
<span><span class="va">Sections</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sur"</span>, <span class="st">"rep"</span>, <span class="st">"gro"</span><span class="op">)</span></span>
<span><span class="va">Species_list</span> <span class="op">=</span><span class="va">list_surv</span><span class="op">[</span><span class="fl">300</span><span class="op">:</span><span class="fl">400</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="reference/run_txprofile.html">run_txprofile</a></span> <span class="op">(</span>taxa <span class="op">=</span> <span class="va">taxaList</span><span class="op">[</span><span class="va">taxa</span><span class="op">]</span>, </span>
<span>               ZIMSdir <span class="op">=</span><span class="va">ZIMSdirdata</span>,AnalysisDir <span class="op">=</span> <span class="va">analysisDir</span>, PlotDir <span class="op">=</span> <span class="va">plotDir</span>,</span>
<span>               erase_previous <span class="op">=</span> <span class="cn">FALSE</span>,Birth_Type <span class="op">=</span> <span class="st">"Captive"</span>, </span>
<span>               sexCats <span class="op">=</span> <span class="va">BySex</span><span class="op">[[</span><span class="va">taxaList</span><span class="op">[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, inparallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               Species_list <span class="op">=</span> <span class="va">Species_list</span>,  Sections <span class="op">=</span> <span class="va">Sections</span>,  </span>
<span>               extractDate <span class="op">=</span> <span class="va">extractDate</span>, minDate <span class="op">=</span> <span class="va">minDate</span>, </span>
<span>               minBirthDate <span class="op">=</span> <span class="va">minBirthDate</span>, minN <span class="op">=</span> <span class="va">minN</span>,  Global <span class="op">=</span>  <span class="va">Global</span>,</span>
<span>               maxOutl <span class="op">=</span> <span class="va">maxOutl</span>,  spOutLev <span class="op">=</span> <span class="va">spOutLev</span>, </span>
<span>               uncert_birth <span class="op">=</span> <span class="va">uncert_birth</span>, uncert_death<span class="op">=</span> <span class="va">uncert_death</span>,</span>
<span>               uncert_date <span class="op">=</span> <span class="va">uncert_date</span>,</span>
<span>               minInstitution <span class="op">=</span> <span class="va">minInstitution</span>, </span>
<span>               minNsur <span class="op">=</span> <span class="va">minNsur</span>, maxNsur <span class="op">=</span> <span class="va">maxNsur</span>, XMAX <span class="op">=</span> <span class="va">XMAX</span>,</span>
<span>               minlx <span class="op">=</span> <span class="va">minlx</span>, MinBirthKnown <span class="op">=</span> <span class="va">MinBirthKnown</span>, </span>
<span>               Min_MLE <span class="op">=</span> <span class="va">Min_MLE</span>, MaxLE <span class="op">=</span>  <span class="va">MaxLE</span>,</span>
<span>               models_sur <span class="op">=</span> <span class="va">models_sur</span>, shape <span class="op">=</span> <span class="va">shape</span>,</span>
<span>               niter <span class="op">=</span> <span class="va">niter</span>, burnin <span class="op">=</span> <span class="va">burnin</span>, thinning <span class="op">=</span> <span class="va">thinning</span>, </span>
<span>               nchain <span class="op">=</span> <span class="va">nchain</span>, ncpus <span class="op">=</span> <span class="va">ncpus</span>,</span>
<span>               parentProb <span class="op">=</span> <span class="va">parentProb</span>, minNrepro <span class="op">=</span> <span class="va">minNrepro</span>, </span>
<span>               minNparepro <span class="op">=</span> <span class="va">minNparepro</span>, minNseas <span class="op">=</span> <span class="va">minNseas</span>, </span>
<span>               minNlitter <span class="op">=</span> <span class="va">minNlitter</span>, Nday <span class="op">=</span> <span class="va">Nday</span>, </span>
<span>               minNgro <span class="op">=</span> <span class="va">minNgro</span>, minNIgro <span class="op">=</span> <span class="va">minNIgro</span>, MeasureType <span class="op">=</span> <span class="va">MeasureType</span>,</span>
<span>               models_gro <span class="op">=</span> <span class="va">models_gro</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="option-3-run-all-species-from-one-taxa-in-parallel-on-different-computers">Option 3: Run all species from one taxa in parallel on different computers<a class="anchor" aria-label="anchor" href="#option-3-run-all-species-from-one-taxa-in-parallel-on-different-computers"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Run this code changing ipara on each different computer</span></span>
<span><span class="va">XX</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="co"># for example on the first computer:</span></span>
<span><span class="va">ipara</span> <span class="op">=</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co">#Sections to run or to update</span></span>
<span><span class="va">Sections</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sur"</span>, <span class="st">"rep"</span>, <span class="st">"gro"</span><span class="op">)</span></span>
<span><span class="co">#Number of different computers</span></span>
<span></span>
<span><span class="fu"><a href="reference/run_txprofile.html">run_txprofile</a></span> <span class="op">(</span><span class="va">taxaList</span><span class="op">[</span><span class="va">taxa</span><span class="op">]</span>, Species_list <span class="op">=</span> <span class="st">"All"</span>, <span class="va">ZIMSdirdata</span>, </span>
<span>               inparallel <span class="op">=</span> <span class="cn">TRUE</span>, ipara <span class="op">=</span> <span class="va">ipara</span>, npara <span class="op">=</span> <span class="va">XX</span>, </span>
<span>               AnalysisDir <span class="op">=</span> <span class="va">analysisDir</span>, PlotDir <span class="op">=</span> <span class="va">plotDir</span>,</span>
<span>               Sections <span class="op">=</span> <span class="va">Sections</span>, erase_previous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               extractDate <span class="op">=</span> <span class="va">extractDate</span>, minDate <span class="op">=</span> <span class="va">minDate</span>,</span>
<span>               sexCats <span class="op">=</span> <span class="va">BySex</span><span class="op">[[</span><span class="va">taxaList</span><span class="op">[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, </span>
<span>               minN <span class="op">=</span> <span class="va">minN</span>,  Global <span class="op">=</span>  <span class="va">Global</span>,</span>
<span>               maxOutl <span class="op">=</span> <span class="va">maxOutl</span>,  spOutLev <span class="op">=</span> <span class="va">spOutLev</span>, Birth_Type <span class="op">=</span> <span class="st">"Captive"</span>, </span>
<span>               uncert_birth <span class="op">=</span> <span class="va">uncert_birth</span>, uncert_death<span class="op">=</span> <span class="va">uncert_death</span>,</span>
<span>               uncert_date <span class="op">=</span> <span class="va">uncert_date</span>,</span>
<span>               minInstitution <span class="op">=</span> <span class="va">minInstitution</span>, </span>
<span>               minNsur <span class="op">=</span> <span class="va">minNsur</span>, maxNsur <span class="op">=</span> <span class="va">maxNsur</span>, XMAX <span class="op">=</span> <span class="va">XMAX</span>,</span>
<span>               minlx <span class="op">=</span> <span class="va">minlx</span>, MinBirthKnown <span class="op">=</span> <span class="va">MinBirthKnown</span>, </span>
<span>               Min_MLE <span class="op">=</span> <span class="va">Min_MLE</span>, MaxLE <span class="op">=</span>  <span class="va">MaxLE</span>,</span>
<span>               models_sur <span class="op">=</span> <span class="va">models_sur</span>, shape <span class="op">=</span> <span class="va">shape</span>,</span>
<span>               niter <span class="op">=</span> <span class="va">niter</span>, burnin <span class="op">=</span> <span class="va">burnin</span>, thinning <span class="op">=</span> <span class="va">thinning</span>, </span>
<span>               nchain <span class="op">=</span> <span class="va">nchain</span>, ncpus <span class="op">=</span> <span class="va">ncpus</span>,</span>
<span>               parentProb <span class="op">=</span> <span class="va">parentProb</span>, minNrepro <span class="op">=</span> <span class="va">minNrepro</span>, </span>
<span>               minNparepro <span class="op">=</span> <span class="va">minNparepro</span>, minNseas <span class="op">=</span> <span class="va">minNseas</span>, </span>
<span>               minNlitter <span class="op">=</span> <span class="va">minNlitter</span>, Nday <span class="op">=</span> <span class="va">Nday</span>, </span>
<span>               minNgro <span class="op">=</span> <span class="va">minNgro</span>, minNIgro <span class="op">=</span> <span class="va">minNIgro</span>, MeasureType <span class="op">=</span> <span class="va">MeasureType</span>,</span>
<span>               models_gro <span class="op">=</span> <span class="va">models_gro</span></span>
<span>               </span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="find-species-with-sex-with-50-1000-individuals">Find species with sex with 50-1000 individuals<a class="anchor" aria-label="anchor" href="#find-species-with-sex-with-50-1000-individuals"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">minNsur</span> <span class="op">=</span> <span class="fl">10000000</span> <span class="co">#Minimum number of individuals</span></span>
<span><span class="co">#Sections to run or to update</span></span>
<span><span class="va">Sections</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sur"</span><span class="op">)</span></span>
<span><span class="va">Species_list</span> <span class="op">=</span> <span class="st">"All"</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">taxa</span> <span class="kw">in</span> <span class="fl">6</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="reference/run_txprofile.html">run_txprofile</a></span> <span class="op">(</span><span class="va">taxaList</span><span class="op">[</span><span class="va">taxa</span><span class="op">]</span>, Species_list <span class="op">=</span> <span class="va">Species_list</span>, <span class="va">ZIMSdirdata</span>,</span>
<span>                 AnalysisDir <span class="op">=</span> <span class="va">analysisDir</span>, PlotDir <span class="op">=</span> <span class="va">plotDir</span>,</span>
<span>                 Sections <span class="op">=</span> <span class="va">Sections</span>, erase_previous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 extractDate <span class="op">=</span> <span class="va">extractDate</span>, minDate <span class="op">=</span> <span class="va">minDate</span>,</span>
<span>                 sexCats <span class="op">=</span> <span class="va">BySex</span><span class="op">[[</span><span class="va">taxaList</span><span class="op">[</span><span class="va">taxa</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                 minN <span class="op">=</span> <span class="va">minN</span>,  Global <span class="op">=</span>  <span class="va">Global</span>,</span>
<span>                 maxOutl <span class="op">=</span> <span class="va">maxOutl</span>,  spOutLev <span class="op">=</span> <span class="va">spOutLev</span>, Birth_Type <span class="op">=</span> <span class="st">"Captive"</span>, </span>
<span>                 uncert_birth <span class="op">=</span> <span class="va">uncert_birth</span>, uncert_death<span class="op">=</span> <span class="va">uncert_death</span>,</span>
<span>                 uncert_date <span class="op">=</span> <span class="va">uncert_date</span>,</span>
<span>                 minInstitution <span class="op">=</span> <span class="va">minInstitution</span>, </span>
<span>                 minNsur <span class="op">=</span> <span class="va">minNsur</span>, maxNsur <span class="op">=</span> <span class="va">maxNsur</span>, XMAX <span class="op">=</span> <span class="va">XMAX</span>,</span>
<span>                 minlx <span class="op">=</span> <span class="va">minlx</span>, MinBirthKnown <span class="op">=</span> <span class="va">MinBirthKnown</span>, </span>
<span>                 Min_MLE <span class="op">=</span> <span class="va">Min_MLE</span>, MaxLE <span class="op">=</span>  <span class="va">MaxLE</span>,</span>
<span>                 models_sur <span class="op">=</span> <span class="va">models_sur</span>, shape <span class="op">=</span> <span class="va">shape</span>,</span>
<span>                 niter <span class="op">=</span> <span class="va">niter</span>, burnin <span class="op">=</span> <span class="va">burnin</span>, thinning <span class="op">=</span> <span class="va">thinning</span>, </span>
<span>                 nchain <span class="op">=</span> <span class="va">nchain</span>, ncpus <span class="op">=</span> <span class="va">ncpus</span>,</span>
<span>                 parentProb <span class="op">=</span> <span class="va">parentProb</span>, minNrepro <span class="op">=</span> <span class="va">minNrepro</span>, </span>
<span>                 minNparepro <span class="op">=</span> <span class="va">minNparepro</span>, minNseas <span class="op">=</span> <span class="va">minNseas</span>, </span>
<span>                 minNlitter <span class="op">=</span> <span class="va">minNlitter</span>, Nday <span class="op">=</span> <span class="va">Nday</span>, </span>
<span>                 minNgro <span class="op">=</span> <span class="va">minNgro</span>, minNIgro <span class="op">=</span> <span class="va">minNIgro</span>, MeasureType <span class="op">=</span> <span class="va">MeasureType</span>,</span>
<span>                 models_gro <span class="op">=</span> <span class="va">models_gro</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-the-summary-tables">Make the summary tables<a class="anchor" aria-label="anchor" href="#make-the-summary-tables"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of taxa to summarize -------------------------</span></span>
<span><span class="va">taxaList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mammalia"</span>, <span class="st">"Aves"</span>, <span class="st">"Reptilia"</span>, <span class="st">"Amphibia"</span>, </span>
<span>              <span class="st">"Chondrichthyes"</span>, <span class="st">"Osteichthyes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sex categories ----------------------------------</span></span>
<span><span class="va">BySex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Mammalia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>, </span>
<span>              Aves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span>, </span>
<span>              Reptilia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"All"</span><span class="op">)</span>, </span>
<span>              Amphibia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"All"</span><span class="op">)</span>, </span>
<span>              Chondrichthyes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span>, <span class="st">"All"</span><span class="op">)</span>, </span>
<span>              Osteichthyes <span class="op">=</span> <span class="st">"All"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">SummTab</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_summary.html">make_summary</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{analysisDir}Rdata/Analyser"</span><span class="op">)</span>, </span>
<span>                        SaveDir <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{analysisDir}"</span><span class="op">)</span>,</span>
<span>                        taxaList <span class="op">=</span> <span class="va">taxaList</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                        BySex <span class="op">=</span> <span class="va">BySex</span> ,</span>
<span>                        Sections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sur"</span>, <span class="st">"rep"</span>, <span class="st">"gro"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-the-output-for-the-dev-team">Make the output for the Dev Team<a class="anchor" aria-label="anchor" href="#make-the-output-for-the-dev-team"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/write.html" class="external-link">write</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/rjson/man/toJSON.html" class="external-link">toJSON</a></span><span class="op">(</span><span class="va">repout</span><span class="op">)</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"ISRdata/global/json/%s.json"</span>, </span>
<span>                                     <span class="va">repout</span><span class="op">$</span><span class="va">general</span><span class="op">$</span><span class="va">speciesID</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compress-the-output">Compress the output<a class="anchor" aria-label="anchor" href="#compress-the-output"></a>
</h3>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ISRverse</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Floriane Plard <br><small class="roles"> Author, maintainer, contractor </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/fplard/ISRverse/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/fplard/ISRverse/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/fplard/ISRverse?branch=master" class="external-link"><img src="https://codecov.io/gh/fplard/ISRverse/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Floriane Plard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

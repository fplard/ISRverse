# WARNING - Generated by {fusen} from dev/flat_select.Rmd: do not edit by hand

test_that("select_species works", {
  data(core)
  data(collection)
  out<- select_species (SpeciesName = "Testudo hermanni",
                        coresubset = core, collection,
                        MinDate = "1980-01-01", ExtractDate = "2023-01-01")
  expect_named(out, c("summary",  "data"))
  expect_named(out$summary, c('NRaw', 'NDate', 'NGlobal', 'NBirthType', 'NUncertBirth', 'NAlive', 'FirstDate', 'MaxAgeRaw', 'ExtractDate'))
  expect_equal(out$summary$NRaw,1000)
  expect_equal(out$summary$NDate,1000)
  expect_equal(out$summary$NAlive,0)
  expect_named(out$data, names(core))
  expect_equal(nrow(out$data),out$summary$NUncertBirth)
  expect_true(is.numeric(out$summary$MaxAgeRaw))
  expect_true(is.date(out$summary$FirstDate))
   out<- select_species (SpeciesName = "Testudo hermanni",
                        coresubset = core%>%mutate(LastCollectionScopeType = "Local"), collection,
                        MinDate = "1980-01-01", ExtractDate = "2023-01-01")
 
  
  
  })

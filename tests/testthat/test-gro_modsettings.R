# WARNING - Generated by {fusen} from dev/flat_growth.Rmd: do not edit by hand

logx <- rnorm(100, 0, 1)
logz <- 0.2+ 15 * (1 - exp(-(1) * logx)) +rnorm(100, 0, 0.01)
dat = data.frame(logx = logx, logz = logz)

test_that(
  "Gro_ModSettings error",
  {
    expect_error(
      dat %>% Gro_ModSettings(model = "vonBert"),
      regexp = "The growth models supported are: logistic, gompertz, chapmanRichards, vonBertalanffy , and polynomial")
    expect_error(
      dat$logz %>% Gro_ModSettings(),
      regexp = "data is not a data frame")
  })



test_that(
  "Gro_ModSettings works",
  { 
    expect_named(
      dat %>% Gro_ModSettings(model = "vonBertalanffy"),
      c("growthMod", "np", "namesCoef", "low", "gamstart"))
    a=dat %>% Gro_ModSettings(model = "vonBertalanffy")
    expect_equal(a$np, 3)
    expect_type(a$growthMod, "closure")
    expect_type(a$low, "double")
    expect_type(a$namesCoef, "character")
    expect_named(a$gamstart, c("zinf", "z0", "gamma"))
    a=dat %>% Gro_ModSettings(model = "logistic")
    expect_named(a$gamstart, c("zinf", "xInfl", "gamma"))
    a=dat %>% Gro_ModSettings(model = "gompertz")
    expect_named(a$gamstart, c("zinf", "beta", "gamma"))
    a=dat %>% Gro_ModSettings(model = "chapmanRichards")
    expect_named(a$gamstart, c("zinf",  "beta",  "gamma", "m"))
    a=dat %>% Gro_ModSettings(model = "polynomial")
    expect_named(a$gamstart,c("gam0", "gam1", "gam2", "gam3", "gam4"))
  }
)
